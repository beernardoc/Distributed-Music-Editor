<!doctype html>
<html>
  <head>
    <title>Distributed Music Editor  - Advanced Sound Systems</title>
    <style type="text/css">
      body {
      	font-family: Trebuchet MS, sans-serif;
      	font-size: 15px;
      	color: #444;
      	margin-right: 24px;
      }
      
      h1	{
      	font-size: 25px;
      }
      h2	{
      	font-size: 20px;
      }
      h3	{
      	font-size: 16px;
      	font-weight: bold;
      }
      hr	{
      	height: 1px;
      	border: 0;
      	color: #ddd;
      	background-color: #ddd;
      }
      
      .app-desc {
        clear: both;
        margin-left: 20px;
      }
      .param-name {
        width: 100%;
      }
      .license-info {
        margin-left: 20px;
      }
      
      .license-url {
        margin-left: 20px;
      }
      
      .model {
        margin: 0 0 0px 20px;
      }
      
      .method {
        margin-left: 20px;
      }
      
      .method-notes	{
      	margin: 10px 0 20px 0;
      	font-size: 90%;
      	color: #555;
      }
      
      pre {
        padding: 10px;
        margin-bottom: 2px;
      }
      
      .http-method {
       text-transform: uppercase;
      }
      
      pre.get {
        background-color: #0f6ab4;
      }
      
      pre.post {
        background-color: #10a54a;
      }
      
      pre.put {
        background-color: #c5862b;
      }
      
      pre.delete {
        background-color: #a41e22;
      }
      
      .huge	{
      	color: #fff;
      }
      
      pre.example {
        background-color: #f3f3f3;
        padding: 10px;
        border: 1px solid #ddd;
      }
      
      code {
        white-space: pre;
      }
      
      .nickname {
        font-weight: bold;
      }
      
      .method-path {
        font-size: 1.5em;
        background-color: #0f6ab4;
      }
      
      .up {
        float:right;
      }
      
      .parameter {
        width: 500px;
      }
      
      .param {
        width: 500px;
        padding: 10px 0 0 20px;
        font-weight: bold;
      }
      
      .param-desc {
        width: 700px;
        padding: 0 0 0 20px;
        color: #777;
      }
      
      .param-type {
        font-style: italic;
      }
      
      .param-enum-header {
      width: 700px;
      padding: 0 0 0 60px;
      color: #777;
      font-weight: bold;
      }
      
      .param-enum {
      width: 700px;
      padding: 0 0 0 80px;
      color: #777;
      font-style: italic;
      }
      
      .field-label {
        padding: 0;
        margin: 0;
        clear: both;
      }
      
      .field-items	{
      	padding: 0 0 15px 0;
      	margin-bottom: 15px;
      }
      
      .return-type {
        clear: both;
        padding-bottom: 10px;
      }
      
      .param-header {
        font-weight: bold;
      }
      
      .method-tags {
        text-align: right;
      }
      
      .method-tag {
        background: none repeat scroll 0% 0% #24A600;
        border-radius: 3px;
        padding: 2px 10px;
        margin: 2px;
        color: #FFF;
        display: inline-block;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
  <h1>Distributed Music Editor  - Advanced Sound Systems</h1>
    <div class="app-desc"><p>A firma Advanced Sound Systems (ASS) encontra-se a desenvolver uma aplicação de karaoke para músicos. Esta aplicação distingue-se por não só remover a voz das músicas, mas também remover instrumentos individuais, permitindo a um músico substituir a performance do músico original pela sua. Este novo serviço será disponibilizado online através de um portal web em que o músico pode fazer upload de um ficheiro de música, analisar os instrumentos que compõem a música, selecionar vários instrumentos e finalmente receber um ficheiro novo em que a música contém apenas esses instrumentos.</p>
<p>A tarefa de separar uma música em várias pistas por instrumento é intensiva do ponto de vista de processamento pelo que a ASS contratou os alunos de Computação Distribuída para desenvolver um serviço online capaz de atender às necessidades da empresa com uma qualidade de experiência elevada para o utilizador final (identificação rápida dos instrumentos e construção do novo ficheiro sem o(s) instrumento(s) seleccionados).</p>
<p>Para esta tarefa deverão desenvolver todo o código necessário para a criação de um serviço Web que possa servir em paralelo múltiplos clientes de forma rápida e eficiente recorrendo a computação paralela (aqui conseguido através de paralelização em múltiplos processos/workers independentes que podem estar no mesmo computador ou não).</p>
</div>
    <div class="app-desc">More information: <a href="https://helloreverb.com">https://helloreverb.com</a></div>
    <div class="app-desc">Contact Info: <a href="hello@helloreverb.com">hello@helloreverb.com</a></div>
    <div class="app-desc">Version: 1.0.0</div>
    
    <div class="license-info">All rights reserved</div>
    <div class="license-url">http://apache.org/licenses/LICENSE-2.0.html</div>
  <h2>Access</h2>

  <h2><a name="__Methods">Methods</a></h2>
  [ Jump to <a href="#__Models">Models</a> ]

  <h3>Table of Contents </h3>
  <div class="method-summary"></div>
  <h4><a href="#Music">Music</a></h4>
  <ul>
  <li><a href="#listAll"><code><span class="http-method">get</span> /music</code></a></li>
  <li><a href="#process"><code><span class="http-method">post</span> /music/{music_id}</code></a></li>
  <li><a href="#progress"><code><span class="http-method">get</span> /music/{music_id}</code></a></li>
  <li><a href="#submit"><code><span class="http-method">post</span> /music </code></a></li>
  
  </ul>
  <h4><a href="#System">System</a></h4>
  <ul>
  <li><a href="#jobStats"><code><span class="http-method">get</span> /job/{job_id}</code></a></li>
  <li><a href="#jobs"><code><span class="http-method">get</span> /job</code></a></li>
  <li><a href="#reset"><code><span class="http-method">post</span> /reset</code></a></li>
  </ul>

  <h1><a name="Music">Music</a></h1>
  <div class="method"><a name="listAll"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /music</code></pre></div>
    <div class="method-summary">Listar todas as músicas submetidas (<span class="nickname">listAll</span>)</div>
    <div class="method-notes">Listar todas as músicas submetidas</div>

    <form action="/music" method="get" enctype="multipart/form-data">
      <button>Lista de todas as musicas submetidas</button>
    </form>







    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      array[<a href="#Musica">Musica</a>]
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>[ {
  "name" : "Another One Bites the Dust",
  "music_id" : 123345678,
  "band" : "Queen",
  "tracks" : [ {
    "track_id" : 1,
    "name" : "drums"
  }, {
    "track_id" : 1,
    "name" : "drums"
  } ]
}, {
  "name" : "Another One Bites the Dust",
  "music_id" : 123345678,
  "band" : "Queen",
  "tracks" : [ {
    "track_id" : 1,
    "name" : "drums"
  }, {
    "track_id" : 1,
    "name" : "drums"
  } ]
} ]</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="process"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="post"><code class="huge"><span class="http-method">post</span> /music/{music_id}</code></pre></div>
    <div class="method-summary">Processar uma musica (<span class="nickname">process</span>)</div>
    <div class="method-notes">Requisitar o processamento asincrono (este método deve retornar imediatamente) da música &lt;music_id&gt; com apenas os instrumentos listados através do seu identificador num ficheiro JSON submetido. O sistema deve fazer a separação da música nos seus vários instrumentos, dando origem a um ficheiro por instrumento. No final, o sistema deverá misturar os instrumentos seleccionados num unico ficheiro.</div>

    <script>
      function updateFormAction() {
        var idInput = document.getElementById('id-input');
        var form = document.getElementById('music-form');
        form.action = '/music/' + idInput.value;
      }
    </script>
    
    <form id="music-form"  method="post" enctype="multipart/form-data">
      <input id="id-input" type="number" name="id" value="">
      <input type="checkbox" name="other" value="other"> Other
      <input type="checkbox" name="bass" value="bass"> Bass
      <input type="checkbox" name="drums" value="drums"> Drums
      <input type="checkbox" name="vocals" value="vocals"> Vocals
      <input type="submit" value="Enviar ID" onclick="updateFormAction()">
    </form>



    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">music_id (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; ID da musica a procesar format: int64</div>    </div>  <!-- field-items -->

    <h3 class="field-label">Consumes</h3>
    This API call consumes the following media types via the <span class="header">Content-Type</span> request header:
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Request body</h3>
    <div class="field-items">
      <div class="param">body <a href="#integer">integer</a> (required)</div>
      
            <div class="param-desc"><span class="param-type">Body Parameter</span> &mdash;  </div>
                </div>  <!-- field-items -->





    <!--Todo: process Response Object and its headers, schema, examples -->



    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        <a href="#"></a>
    <h4 class="field-label">404</h4>
    Music not found
        <a href="#"></a>
    <h4 class="field-label">405</h4>
    Track not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="progress"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /music/{music_id}</code></pre></div>
    <div class="method-summary">Estado de processamento de uma musica (<span class="nickname">progress</span>)</div>
    <div class="method-notes">Requisitar o estado de processamento de uma música, quando o estado é 100% a resposta deve incluir o url do ficheiro final. Quando a pista de um instrumento estiver completo deverá retornar o link para o ficheiro de cada instrumento (permitindo ao utilizador fazer o download e reprodução do ficheiro). No final haverá também um link para o ficheiro final misturado (contendo os instrumentos seleccionados).</div>

    <script>
      function updateFormActionGet() {
        var idInput = document.getElementById('id-input-get');
        var form = document.getElementById('music-form-get');
        form.action = '/music/' + idInput.value;
      }
    </script>

    <form id="music-form-get" method="get" enctype="multipart/form-data">
      <input type="number" name="id" value="" id="id-input-get">
      <input type="submit" value="Obter estado de processamento" onclick="updateFormActionGet()">
    </form>



    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">music_id (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; ID da musica a procesar format: int64</div>    </div>  <!-- field-items -->






    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#Progress">Progress</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "instruments" : [ {
    "name" : "guitar",
    "track" : "http://localhost/file/12314"
  }, {
    "name" : "bass",
    "track" : "http://localhost/file/34567"
  } ],
  "final" : "http://localhost/file/31231234",
  "progress" : 0
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        <a href="#Progress">Progress</a>
    <h4 class="field-label">404</h4>
    Music not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="submit"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="post"><code class="huge"><span class="http-method">post</span> /music</code></pre></div>
    <div class="method-summary">Adicionar nova música (<span class="nickname">submit</span>)</div>
    <div class="method-notes">Submeter ficheiros de áudio em formato MP3. Em resposta à submissão do ficheiro de áudio, o serviço deverá retornar um ficheiro JSON contendo um identificador do trabalho (music_id), e uma lista de identificadores das pistas de instrumentos (cada identificador deverá corresponder a um instrumento). Este método apenas armaneza e analisa os metadados da música.</div>

    <form action="/music" method="post" enctype="multipart/form-data">
      <input type="file" accept=".mp3" name="music_file">
      <input type="submit" value="Upload Music">
    </form>
    <h3 class="field-label">Consumes</h3>
    This API call consumes the following media types via the <span class="header">Content-Type</span> request header:
    <ul>
      <li><code>application/octet-stream</code></li>
    </ul>

    <h3 class="field-label">Request body</h3>
    <div class="field-items">
      <div class="param">body <a href="#Object">Object</a> (optional)</div>
      
            <div class="param-desc"><span class="param-type">Body Parameter</span> &mdash;  </div>
                </div>  <!-- field-items -->




    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#Musica">Musica</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "name" : "Another One Bites the Dust",
  "music_id" : 123345678,
  "band" : "Queen",
  "tracks" : [ {
    "track_id" : 1,
    "name" : "drums"
  }, {
    "track_id" : 1,
    "name" : "drums"
  } ]
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        <a href="#Musica">Musica</a>
    <h4 class="field-label">405</h4>
    Invalid input
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <h1><a name="System">System</a></h1>
  <div class="method"><a name="jobStats"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /job/{job_id}</code></pre></div>
    <div class="method-summary">Informação sobre um Job (<span class="nickname">jobStats</span>)</div>
    <div class="method-notes">estatísticas de um dado Job (tamanho do ficheiro, link para os vários ficheiros, tempos de processamento, music_id, etc.)</div>

    <script>
      function submitForm() {
          var musicId = document.getElementById('music_id').value;
          var form = document.getElementById('job_form');
          form.action = "/job/" + musicId;
          form.submit();
      }
    </script>
  
    <form id="job_form" method="get">
      <input type="number" id="music_id" name="music_id" value="">
      <input type="button" value="Processar Job" onclick="submitForm()">
    </form>


    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">job_id (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; ID do JOB format: int64</div>    </div>  <!-- field-items -->






    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#Job">Job</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "size" : 1048576,
  "job_id" : 1334,
  "track_id" : "",
  "music_id" : 0,
  "time" : 12312
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        <a href="#Job">Job</a>
    <h4 class="field-label">404</h4>
    Job not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="jobs"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /job</code></pre></div>
    <div class="method-summary">Listar todos Jobs (<span class="nickname">jobs</span>)</div>
    <div class="method-notes">Listar todos Jobs (Job é uma tarefa distribuída a um worker) submetidos</div>


    <form action="/job" method="get" enctype="multipart/form-data">
      <input type="submit" value="Lista de todos os Jobs">
    </form>







    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      
      array[Integer]
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>[ 3133121, 3164892, 3313176 ]</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        
    <h4 class="field-label">405</h4>
    Invalid input
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="reset"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="post"><code class="huge"><span class="http-method">post</span> /reset</code></pre></div>
    <div class="method-summary">Reiniciar o sistema (<span class="nickname">reset</span>)</div>
    <div class="method-notes">Apagar todos ficheiros temporários e músicas (sistema limpo), cancelar todos os workers ainda em funcionamento.</div>


    <form action="/reset" method="post" enctype="multipart/form-data">
      <input type="submit" value="Server Reset">
    </form>








    <!--Todo: process Response Object and its headers, schema, examples -->



    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    successful operation
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>

  <h2><a name="__Models">Models</a></h2>
  [ Jump to <a href="#__Methods">Methods</a> ]

  <h3>Table of Contents</h3>
  <ol>
    <li><a href="#Instrument"><code>Instrument</code></a></li>
    <li><a href="#Job"><code>Job</code></a></li>
    <li><a href="#Musica"><code>Musica</code></a></li>
    <li><a href="#Progress"><code>Progress</code></a></li>
    <li><a href="#Track"><code>Track</code></a></li>
  </ol>

  <div class="model">
    <h3><a name="Instrument"><code>Instrument</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">name (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: guitar</span></div>
<div class="param">track (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  format: uri</div>
          <div class="param-desc"><span class="param-type">example: http://localhost/file/12314</span></div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="Job"><code>Job</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">job_id (optional)</div><div class="param-desc"><span class="param-type"><a href="#long">Long</a></span>  format: int64</div>
          <div class="param-desc"><span class="param-type">example: 1334</span></div>
<div class="param">size (optional)</div><div class="param-desc"><span class="param-type"><a href="#integer">Integer</a></span> in bytes </div>
          <div class="param-desc"><span class="param-type">example: 1048576</span></div>
<div class="param">time (optional)</div><div class="param-desc"><span class="param-type"><a href="#integer">Integer</a></span> in seconds format: timestamp</div>
          <div class="param-desc"><span class="param-type">example: 12312</span></div>
<div class="param">music_id (optional)</div><div class="param-desc"><span class="param-type"><a href="#long">Long</a></span> Id da musica que deu origem a este job format: int64</div>
<div class="param">track_id (optional)</div><div class="param-desc"><span class="param-type"><a href="#"></a></span>  </div>
      <div class="param-desc"><span class="param-type">oneOf:</span>
      </div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="Musica"><code>Musica</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">music_id (optional)</div><div class="param-desc"><span class="param-type"><a href="#long">Long</a></span>  format: int64</div>
          <div class="param-desc"><span class="param-type">example: 123345678</span></div>
<div class="param">name (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: Another One Bites the Dust</span></div>
<div class="param">band (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: Queen</span></div>
<div class="param">tracks (optional)</div><div class="param-desc"><span class="param-type"><a href="#Track">array[Track]</a></span>  </div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="Progress"><code>Progress</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">progress (optional)</div><div class="param-desc"><span class="param-type"><a href="#integer">Integer</a></span>  </div>
<div class="param">instruments (optional)</div><div class="param-desc"><span class="param-type"><a href="#Instrument">array[Instrument]</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: [{&quot;name&quot;:&quot;guitar&quot;,&quot;track&quot;:&quot;http://localhost/file/12314&quot;},{&quot;name&quot;:&quot;bass&quot;,&quot;track&quot;:&quot;http://localhost/file/34567&quot;}]</span></div>
<div class="param">final (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  format: uri</div>
          <div class="param-desc"><span class="param-type">example: http://localhost/file/31231234</span></div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="Track"><code>Track</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">name (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: drums</span></div>
<div class="param">track_id (optional)</div><div class="param-desc"><span class="param-type"><a href="#long">Long</a></span>  format: int64</div>
          <div class="param-desc"><span class="param-type">example: 1</span></div>
    </div>  <!-- field-items -->
  </div>
  </body>
</html>
